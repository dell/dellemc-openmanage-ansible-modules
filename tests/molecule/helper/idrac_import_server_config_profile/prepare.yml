---
- name: Making sure Server is powered on and clear all job
  ansible.builtin.include_tasks:
    file: ../helper/common/power_on_idrac_and_clear_all_job.yaml

- name: Prepare config
  ansible.builtin.import_role:
    name: dellemc.openmanage.idrac_import_server_config_profile
  vars:
    hostname: "{{ lookup('env', 'IDRAC_IP') }}"
    username: "{{ lookup('env', 'IDRAC_USER') }}"
    password: "{{ lookup('env', 'IDRAC_PASSWORD') }}"
    validate_certs: false
    import_buffer: "{ \"SystemConfiguration\": {\"Components\": [
      { \"FQDD\": \"iDRAC.Embedded.1\",\"Attributes\": [{ \"Name\": \"Time.1#Timezone\",
      \"Value\": \"UTC\",
      \"Set On Import\": \"True\",
      \"Comment\": \"Read and Write\" }]},{ \"FQDD\":
          \"RAID.Integrated.1-1\",\"Attributes\": [{ \"Name\": \"RAIDrebuildRate\",
          \"Value\": \"31\",
          \"Set On Import\": \"True\",
          \"Comment\": \"Read and Write\" }]}]}}"
